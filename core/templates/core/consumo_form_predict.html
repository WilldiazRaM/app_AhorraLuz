{% extends "base.html" %}
{% block title %}Nuevo consumo + Predicción{% endblock %}

{% block content %}
<div class="card shadow-sm">
  <div class="card-body">
    <h5 class="card-title mb-3"><i class="fa-solid fa-bolt me-2"></i>Nuevo consumo y predicción</h5>

    <form method="post" class="row g-3 mb-3">
      {% csrf_token %}
      {{ form.as_p }}

      <!-- Campos extra para features (si no vienen en el form) -->
      <div class="col-md-4">
        <label class="form-label">Temp (°C)</label>
        <input type="number" step="0.1" name="temp_c" class="form-control" placeholder="Ej: 18.5">
      </div>
      <div class="col-12">
        <button class="btn btn-brand" type="submit">
          <i class="fa-solid fa-chart-line me-1"></i> Guardar y predecir
        </button>
        <a class="btn btn-outline-secondary ms-2" href="{% url 'core:home' %}">
          Volver al inicio
        </a>
      </div>
    </form>

    {% if yhat is not None %}
    <div class="alert {% if nivel == 'ALTA' %}alert-danger{% elif nivel == 'MEDIA' %}alert-warning{% elif nivel == 'BAJA' %}alert-info{% else %}alert-success{% endif %}">
      <div class="fw-semibold">
        Predicción estimada (próxima hora): {{ yhat|floatformat:2 }} kWh
      </div>
      <div>{{ alerta }}</div>
    </div>
    {% endif %}
  </div>
</div>
{% endblock %}
